{% extends "base.html" %}
{% block title %} CheckNerds - {{ UserNickName }}已完成项目 {% endblock title %}
		{% block content-holder %}
  		<div id="leftside">
            	<div id="featuredcode2">
                	<div id="featuredcode2-top"></div>
                   	<div id="featuredcode2-mid">
					<h2 class="posttitle" style="font-weight:normal;">{{UserNickName}}</a> &raquo; 已完成的项目</h2>
 
						<table id='mt' cellpadding="0" cellspacing="0" border="0" align="left"><tbody><tr><th colspan="2" class="viewitem_title">&nbsp;{{DoneStatus}}</th></tr><tr><th width="70%" class="viewitem_tags">名称</th><th class="viewitem_tags">添加日期</th></tr>	
						</tbody></table>
						
						<div id="Pagination" class="pagination" style="clear:both;"></div>
						
						<!-- http://www.positioniseverything.net/easyclearing.html --!>
						<div style="clear:both;"></div>

                </div>
                <div id="featuredcode2-bot"></div>
            </div>
			<script type="text/javascript">
				function pageselectCallback(page_id, jq){
						
						var $table = $('#mt');
						$table.children('tbody').empty();
						$table.children('tbody').append('<tr><th colspan="2" class="viewitem_title">&nbsp;{{DoneStatus}}</th></tr><tr><th width="70%" class="viewitem_tags">名称</th><th class="viewitem_tags">添加日期</th></tr>');

						//var rows = $table.find('tbody > tr').get();

						$.getJSON("/ajax/getjson_userdoneitems",function(json){
							//http://liuyami.com/archives/14.html
							for(var i=((page_id*10)+1); i<=((page_id*10)+10); i++)
							{
								var dispstr = '<tr colspan="2"><td class="viewitem_creator"><img src="/img/accept16.png">' + '<a href="/i/' + json[i].id + '">' + json[i].name;
								dispstr = dispstr + '' + json[i].comment + '</td><td>' + json[i].date + '</td></tr>';
								
								//ideas inspired by http://www.packtpub.com/article/jquery-table-manipulation-part1
								$table.children('tbody').append(dispstr);
							}
						});
						//$("#alist").append('</tbody></table>');
                }
			
            	window.onload = function() {
					//http://bbs.jquery.org.cn/viewthread.php?tid=1739
					$.ajaxSetup({async:false});
					
					var icount;
					$.getJSON("/ajax/getjson_userdoneitems",function(json){
						icount = json.length-1;
					});
					
					// Create pagination element					
					$("#Pagination").pagination(icount, {
						num_edge_entries: 2,
						num_display_entries: 10,
						prev_text: '上一页',
						next_text: '下一页',
						callback: pageselectCallback
                	});
					pageselectCallback(0); //show the first page.
				}
   			</script>
        {% endblock content-holder %}
