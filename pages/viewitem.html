{% extends "base.html" %}
{% block title %} CheckNerds - {{ tarsusaItem.name|escape }} - 查看项目 {% endblock title %}

			{% block content-holder %}
        	<div id="leftside">
            	<div id="featuredcode2">
                	<div id="featuredcode2-top"></div>
                   	<div id="featuredcode2-mid">

					<h2 class="posttitle" style="font-weight:normal;">{{ singlePageTitle }} - {{tarsusaItem.name|escape}} </h2>
					<p>
				
					{% if DonelogItemCollection %}
						{% for DonelogItem in DonelogItemCollection %}
							{{ DonelogItem.donedate }}<br />
							Name: {{ DonelogItem.name|escape }}<br />
						{% endfor %}
					{% endif %}

					{% if tarsusaItem %}
						<table cellpadding="0" cellspacing="0" border="0" align="left">
						<tr>
							<th class="viewitem_title" width="90%">{{ tarsusaItem.name|escape }}&nbsp;&nbsp;</th>
							<th>
							{% if not logictag_OtherpeopleViewThisItem %}
								<a href="/ajax/allpage_edititem/{{tarsusaItem.key.id}}?TB_iframe=true&height=400&width=400" class="thickbox" title="编辑项目"><img src="/img/page_edit.png" alt="编辑项目"></a>
								<a href="#;" onclick="if (confirm('确认删除？{{tarsusaItem.name|escape}}')) {ajax_deleteItem('/removeItem/{{tarsusaItem.key.id}}');}"><img src="/img/delete.png" alt="删除项目"></a>
							{% endif %}
							</th>
						</tr>
						<tr>
							<th colspan="2" class="viewitem_tags"><span class="date">分类：{{tarsusaItemTags}}</span></th>
						</tr>
						<tr> 
							<td colspan="2" class="viewitem_creator">创建者：<a href="/user/{{tarsusaItem.usermodel.key.id|escape}}">{{tarsusaItem.usermodel.dispname|escape}}</a>
							&nbsp;&nbsp;
							{% ifequal tarsusaItem.public "private" %}
								不公开
							{% endifequal %}
							{% ifequal tarsusaItem.public "publicOnlyforFriends" %}
								仅对朋友公开
							{% endifequal %}
							{% ifequal tarsusaItem.public "public" %}
								完全公开
							{% endifequal %}
							</td></tr>
						<tr>
							<td colspan="2" class="viewitem_comment">说明:&nbsp; {{ tarsusaItem.comment }}</td>
						</tr>
						<tr><td width="50%" colspan="2" class="rowB"><span class="date">创建时间： &nbsp; {{tarsusaItem.date }}
						&nbsp;|&nbsp;
							{% if not tarsusaItem.expectdate %}
								没有完成期限限制
							{% else %}
								预期完成： &nbsp; {{tarsusaItem.expectdate}}
							{% endif %}
							</span>
						</td></tr>

						<tr><td colspan="2" class="rowA">
						{% if tarsusaItemDone %}
							<img src="/img/accept16.png">
							已经完成于{{ tarsusaItem.donedate }} &nbsp;							
							{% if not logictag_OtherpeopleViewThisItem %}
								<a href="#;" onclick="if (confirm('确认撤销完成？{{tarsusaItem.name|escape}}')) {ajax_undoneItem('/undoneItem/{{tarsusaItem.key.id}}');}" class="x">撤销完成</a>
							{% endif %}
						{% else %}
							{% if not tarsusaRoutineItem %}
								当前状态：未完成
								{% if tarsusaItem.expired %}
									<span style="color: #F00000">注意：此任务已过期！</span>
								{% endif %}
							{% else %}
								{% ifequal tarsusaItem.routine "daily" %}
									每日任务
								{% endifequal %}
								{% ifequal tarsusaItem.routine "weekly" %}
									每周任务
								{% endifequal %}
								{% ifequal tarsusaItem.routine "monthly" %}
									每月任务
								{% endifequal %}
								{% ifequal tarsusaItem.routine "seasonly" %}
									每季度任务
								{% endifequal %}
								{% ifequal tarsusaItem.routine "yearly" %}
									每年任务
								{% endifequal %}	
							
							<tr><td colspan="2" class="rowB">最近完成<br />
							{% for eachRoutineLogItem in tarsusaRoutineLogItem %}
								{{ eachRoutineLogItem.donedate}} &nbsp; <br />
							{% endfor %}
							
							{% endif %}

						{% endif %}

						{% if not logictag_OtherpeopleViewThisItem %}
							{% if not tarsusaRoutineItem %}
								{% if not tarsusaItemDone %}
									<input type="button" value="完成这个任务" name="donebutton" onclick="ajax_doneItem('/doneItem/{{tarsusaItem.key.id}}')";>
								{% endif %}
								&nbsp; <a href="#;" onclick="if (confirm('确认删除项目？{{tarsusaItem.name|escape}}')) { location.href = '/removeItem/{{tarsusaItem.key.id}}';}" class="x">x</a>
							{% endif %}
						{% endif %}
						</td></tr>
						</table>
					{% endif %}
					</p>
					</div>
               	<div id="featuredcode2-bot"></div>
            </div>
				 
				<div id="div-leftbottom-relateditems-top"></div>
				<div id="div-leftbottom-relateditems-mid">
					<h2 class="posttitle"><a href="/">相关信息</a></h2>
				<p>
			 	{% if logictag_OtherpeopleViewThisItem %}
				{{ItemBelongsToUser}}在{{TheDayCreated}}那天还创建了<br />
					{% if not logictag_CurrentUserIsOneofAuthorsFriends %}					
						{% for tarsusaItem_SameDayCreated in tarsusaItemCollection_SameDayCreated %}
							{% ifnotequal tarsusaItem_SameDayCreated.public "public" %}
								{% if tarsusaItem_SameDayCreated.done %}
									<img src='/img/accept16.png'><a href="/i/{{ tarsusaItem_SameDayCreated.key.id }}">>{{ tarsusaItem_SameDayCreated.name|escape }}</a></br>
								{% else %}
									<a href="/i/{{ tarsusaItem_SameDayCreated.key.id }}">>{{ tarsusaItem_SameDayCreated.name|escape }}</a></br>
								{% endif %}
							{% endifnotequal %}
						{% endfor %}
					{% else %}
						{{htmlstring_outputStringRoutineLog}}
					{% endif %}
							    
				{% else %}							   
				在{{TheDayCreated}}那天还创建了<br />
					<div id="todoitems">
						{% for tarsusaItem_SameDayCreated in tarsusaItemCollection_SameDayCreated %}
							<li>
							{% if tarsusaItem_SameDayCreated.done %}
								<img src="/img/accept16.png">	
							{% else %}
								<input type="checkbox" name="checkboxname" onchange="ajax_doneItem('/doneItem/{{tarsusaItem_SameDayCreated.key.id}}')">
							{% endif %}
							<a href="/i/{{ tarsusaItem_SameDayCreated.key.id }}">{{ tarsusaItem_SameDayCreated.name|escape }}</a>
							<a href="#;" onclick="if (confirm('确认删除？{{tarsusaItem_SameDayCreated.name|escape}}')) {ajax_deleteItem('/removeItem/{{tarsusaItem_SameDayCreated.key.id}}');}" class="x">x</a></li>
						{% endfor %}
					</div>
				{% endif %}
		
				</p>
				</div>
				<div id="div-leftbottom-relateditems-bot"></div>
			</div>
			</div>


			<div id="rightside">
            	<div id="codelist">
                	<div id="codelist-top"></div>
                	<div id="codelist-mid">
                    	<h2 class="posttitle">{{UserNickName}}</h2>
                        <ul>
                            <li><img src="/img/add.png"><a href="/ajax/allpage_additem/?TB_iframe=true&height=400&width=400" class="thickbox" title="添加新项目">添加项目</a></li>
							<li><img src="/img/globe_accept.png"><a href="#">完成日志</a></li>
							<li><img src="/img/info.png"><a href="#">用户信息</a></li>
                        </ul>
                    </div>
                	<div id="codelist-bot"></div>
                </div>

				{% if not logictag_OtherpeopleViewThisItem %}
				<div id="div_itemstats">
					<div id="codelist">
						<div id="codelist-top"></div>
						<div id="codelist-mid">
							<h2 class="posttitle">统计信息</h2>
							<ul>
							正在载入
							</ul>
						</div>
						<div id="codelist-bot"></div>
					</div>
				</div>
				{% endif %}
						
			<script type="text/javascript">
				{% if not logictag_OtherpeopleViewThisItem %}
				window.onload = function() {
					$('#div_itemstats').load('/ajax/frontpage_getitemstats');
				}
				{% endif %}
				
				function ajax_doneItem(strLink){
				$.ajax({type: "GET", url: strLink ,success: function(){location.reload();}}); 
				return false;
				}
				
				function ajax_undoneItem(strLink){
				$.ajax({type: "GET", url: strLink ,success: function(){location.reload();}}); 
				return false;
				}

				function ajax_deleteItem(strLink){
				$.ajax({type: "GET", url: strLink ,success: function(){location.href="/";}}); 
				return false;
				}
				</script>
								

        {% endblock content-holder %}
